<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sktelecom.cep.dao.DatastoreDao">

    <resultMap id="DatastoreMap" type="com.sktelecom.cep.vo.Datastore">
        <result property="id" column="datstore_id" />
        <result property="name" column="datstore_name" />
        <result property="type" column="datstore_type" />
        <result property="subType" column="datastore_subtype" />
        <result property="hostName" column="host_name" />
        <result property="portNum" column="port_num" />
        <result property="username" column="cred_user_info" />
        <result property="password" column="cred_pass_info" />
        <result property="description" column="description" />
        <result property="updateTime" column="update_date" javaType="java.sql.Timestamp" />
        <result property="updateUserId" column="update_user_id" />
        <collection property="properties" ofType="com.sktelecom.cep.entity.DataStoreProperty">
            <id property="id" column="datastore_id"/>
            <result property="name" column="prop_name"/>
            <result property="value" column="prop_value"/>
        </collection>
    </resultMap>
    <resultMap id="DatastorePropertyMap" type="com.sktelecom.cep.entity.DataStoreProperty">
        <result property="id" column="datstore_id" />
    </resultMap>

    <insert id="create" parameterType="com.sktelecom.cep.vo.Datastore">
        INSERT INTO datastore(datstore_id, datstore_name, datstore_type, datstore_subtype, host_name, port_num, cred_user_info, cred_pass_info, description, update_date, update_user_id)
        VALUES (#{id}, #{name}, #{type}, #{subType}, #{hostName}, #{portNum}, #{credUserInfo}, #{credPassInfo}, #{description}, NOW(), #{updateUserId})
    </insert>

    <update id="update" parameterType="com.sktelecom.cep.vo.Datastore">
        UPDATE datastore
        SET datstore_name = #{name}
	        ,datstore_type = #{type}
	        ,datstore_subtype = #{subType}
	        ,host_name = #{hostName}
	        ,port_num = #{portNum}
	        ,cred_user_info = #{credUserInfo}
	        ,cred_pass_info = #{credPassInfo}
	        ,description = #{description}
	        ,update_date = NOW()
	        ,update_user_id = #{updateUserId}
        WHERE datstore_id = #{id}
    </update>

    <delete id="delete" parameterType="com.sktelecom.cep.vo.Datastore">
        DELETE FROM datastore
        WHERE datstore_id = #{id}
    </delete>

    <select id="getInfo" parameterType="com.sktelecom.cep.vo.Datastore" resultMap="DatastoreMap">
        SELECT datstore_id, datstore_name, datstore_type, datstore_subtype, host_name, port_num, cred_user_info, cred_pass_info, description, update_date, update_user_id
        FROM datastore
        WHERE datstore_id = #{id}
    </select>

    <select id="getList" resultMap="DatastoreMap" parameterType="com.sktelecom.cep.vo.Datastore">
        SELECT datstore_id, datstore_name, datstore_type, datstore_subtype, host_name, port_num, cred_user_info, cred_pass_info, description, update_date, update_user_id
        FROM datastore
    </select>

</mapper>
